<!doctype html>
<html lang="zxx">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>aranoz</title>
    <link rel="icon" href="img/favicon.png">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <!-- animate CSS -->
    <link rel="stylesheet" href="css/animate.css">
    <!-- owl carousel CSS -->
    <link rel="stylesheet" href="css/owl.carousel.min.css">
    <!-- nice select CSS -->
    <link rel="stylesheet" href="css/nice-select.css">
    <!-- font awesome CSS -->
    <link rel="stylesheet" href="css/all.css">
    <!-- flaticon CSS -->
    <link rel="stylesheet" href="css/flaticon.css">
    <link rel="stylesheet" href="css/themify-icons.css">
    <!-- font awesome CSS -->
    <link rel="stylesheet" href="css/magnific-popup.css">
    <!-- swiper CSS -->
    <link rel="stylesheet" href="css/slick.css">
    <link rel="stylesheet" href="css/price_rangs.css">
    <!-- style CSS -->
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
    <!--::header part start::-->
    <header class="main_menu home_menu">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-12">
                    <nav class="navbar navbar-expand-lg navbar-light">
                        <a class="navbar-brand" href="/home" style="font-weight: bolder;">sofazen</a>
                        <button class="navbar-toggler" type="button" data-toggle="collapse"
                            data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                            aria-expanded="false" aria-label="Toggle navigation">
                            <span class="menu_icon"><i class="fas fa-bars"></i></span>
                        </button>


                        <div class="collapse navbar-collapse main-menu-item" id="navbarSupportedContent">
                            <ul class="navbar-nav">


                                <li class="nav-item dropdown">
                                    <a class="nav-link" href="/" id="navbarDropdown_1" role="button">
                                        Home
                                    </a>

                                </li>
                                <li class="nav-item dropdown">
                                    <a class="nav-link" href="/shop" id="navbarDropdown_1" role="button">
                                        Shop
                                    </a>

                                </li>
                                <!-- data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" -->
                                <!-- <% if(locals.user) { %>
                                    <li class="nav-item dropdown">
                                        <a class="nav-link " href="/logout" id="navbarDropdown_3" role="button">
                                            logout
                                        </a>

                                    </li>

                                    <% }else { %>
                                        <li class="nav-item dropdown">
                                            <a class="nav-link " href="/login" id="navbarDropdown_3" role="button">
                                                login
                                            </a>

                                        </li>

                                        <% } %> -->

                                <li class="nav-item dropdown">
                                    <a class="nav-link " href="/profile" id="navbarDropdown_2" role="button">
                                        Profile
                                    </a>

                                </li>


                            </ul>
                        </div>
                        <div class="hearer_icon d-flex">
                            <!-- <a id="search_1" href="javascript:void(0)"><i class="ti-search"></i></a> -->
                            <a href="/wishlistLoad"><i class="ti-heart"></i></a>
                            <div class="dropdown ">
                                <a class="dropdown" href="/cart" id="navbarDropdown3" role="button">
                                    <i class="fas fa-cart-plus"></i>
                                </a>
                                <!-- <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                                    <div class="single_product">
    
                                    </div>
                                </div> -->

                            </div>
                        </div>
                    </nav>
                </div>
            </div>
        </div>

    </header>
    <!-- Header part end-->

    <!--================Home Banner Area =================-->
    <!-- breadcrumb start-->
    <section class="breadcrumb breadcrumb_bg">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-8">
                    <div class="breadcrumb_iner">
                        <div class="breadcrumb_iner_item">
                            <h2>Shop Category</h2>
                            <p>Home <span>-</span> Shop Category</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- breadcrumb start-->

    <!--================Category Product Area =================-->
    <section class="cat_product_area section_padding">
        <div class="container">
            <div class="row">
                <div class="col-lg-3">
                    <div class="left_sidebar_area">


                        <!-- <style>
                            .list {
                                list-style: none;
                                padding: 0;
                            }

                            .list li {
                                margin-bottom: 10px;
                            }

                            .list a {
                                display: block;
                                padding: 10px;
                                text-decoration: none;
                                color: #333;
                                /* Adjust the text color as needed */
                                border: 2px solid transparent;
                                /* Adjust the border width */
                                transition: border-color 0.3s;
                            }

                            .list a:hover {
                                border-color: #ff69b4;
                                /* Pink color */
                            }

                            .list p {
                                color: #555;
                                /* Adjust the text color for the "no categories" message */
                            }
                        </style> -->
                        <!-- <aside class="left_widgets p_filter_widgets price_rangs_aside">
                            <div class="l_w_title">
                                <h3>Price Filter</h3>
                            </div>
                            <div class="widgets_inner">
                                <div class="range_item">
                                    <div id="slider-range"></div>
                                    <input type="text" class="js-range-slider" value="" />
                                    <div class="d-flex">
                                        <div class="price_text">
                                            <p>Price :</p>
                                        </div>
                                        <div class="price_value d-flex justify-content-center">
                                            <input type="text" class="js-input-from" id="amount" readonly />
                                            <span>to</span>
                                            <input type="text" class="js-input-to" id="amount" readonly />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </aside> -->
                        <!-- <aside class="left_widgets p_filter_widgets">
                            <div class="l_w_title">
                                <h3>ALL CATEGORIES</h3>
                            </div>
                            <div class="widgets_inner">
                                <ul class="list">
                                    <li>
                                        <a href="/shop">SHOW ALL PRODUCTS</a>
                                    </li>
                                    <% if (Categories.length> 0) { %>
                                        <ul>
                                            <% for (let i=0; i < Categories.length; i++) { %>
                                                <li>
                                                    <a href="/shop?categid=<%= Categories[i].id %>">
                                                        <%= Categories[i].name %>
                                                    </a>
                                                </li>
                                                <% } %>
                                        </ul>
                                        <% } else { %>
                                            <li>
                                                <p>There are no categories.</p>
                                            </li>
                                            <% } %>
                                </ul>
                            </div>
                        </aside> -->

                        <input type="hidden" id="user" value="<%=user%>">
                        <!-- <aside class="left_widgets p_filter_widgets">
                            <div class="l_w_title">
                                <h3>Color Filter</h3>
                            </div>
                            <div class="widgets_inner">
                                <ul class="list">
                                    <li>
                                        <a href="#">Black</a>
                                    </li>
                                    <li>
                                        <a href="#">Black Leather</a>
                                    </li>
                                    <li class="active">
                                        <a href="#">Black with red</a>
                                    </li>
                                    <li>
                                        <a href="#">Gold</a>
                                    </li>
                                    <li>
                                        <a href="#">Spacegrey</a>
                                    </li>
                                </ul>
                            </div>
                        </aside> -->
                        <!-- <div class="col-lg-12">
                            <a class="btn_1" href="/shop"> clear</a>
                        </div> -->

                    </div>
                </div>
                
                <div class="col-lg-9">
                    <div class="row">
                        <div class="col-lg-12">
                            <div class="product_top_bar d-flex justify-content-between align-items-center">
                                <div class="single_product_menu">
                                    <p><span> </span> Prodict Found</p>
                                </div>
                                <div class="single_product_menu d-flex">
                                    <h5>short by : </h5>

                                    <select id="categorySelect" onchange="redirectToCategory(this)">
                                        <option ><a href="/">All</a></option>
                                        <% for(let i=0; i< Categories.length; i++) { %>
                                            <option value="<%= Categories[i].id %>">
                                                <%= Categories[i].name %>
                                            </option>
                                            <% } %>
                                    </select>
                                    <script>
                                      
                                        function redirectToCategory(select) {
                                            const categoryId = select.value;
                                            $('#searchInput').val(categoryId); 

                                            $.ajax({
                                                url: "/shopFilter",
                                                method: "POST",
                                                data: { categoryId: categoryId },
                                                success: function (response) {
                                                    const products = response.products;


                                                    $('#product-list').empty(); // Clear existing products
                                                    products.forEach(product => {
                                                        $('#product-list').append(`
    <div class="col-lg-4 col-sm-6">
        <div class="single_product_item">
            <a >
                <img src="SharpImage/${product.image[1]}" alt="img">
            </a>
            <div class="single_product_text">
                <h4>${product.name}</h4>
                ${product.Offer ? `
                        <h7>
                            <h3>₹${(product.price - (product.price * product.Offer.percentage / 100)).toFixed(2)}</h3>
                            <del>₹${product.price}</del>
                        </h7>
                    ` : product.category.Offer ? `
                        <h3>₹${(product.price - (product.price * product.category.Offer.percentage / 100)).toFixed(2)}</h3>
                        <del>₹${product.price}</del>
                    ` : `
                        <h3>₹${product.price}</h3>
                    `
                                                            }
                <!-- Add to Cart button -->
                <a href="#" class="add_cart" onclick="addToCart('${product._id}','${product.name}','${product.price}','${product.category.name}','${product.brand}')">+ Add to Cart</a>
                <a href="#" class="add_wishlist" onclick="addToWishlist('${product._id}')">Add to Wishlist</a>
            </div>
        </div>
    </div>
`);
                                                    });
                                                },
                                                error: function (error) {
                                                    console.error('Error:', error);
                                                }
                                            });
                                        }

                                    </script>

                                </div>
                                <div class="single_product_menu d-flex">
                                    <!-- <h5>show :</h5> -->
                                    <div class="top_pageniation">
                                        <!-- <ul>
                                            <li>1</li>
                                            <li>2</li>
                                            <li>3</li>
                                        </ul> -->
                                    </div>
                                </div>
                                <div class="single_product_menu d-flex">
                                    <div class="input-group">
                                        <input type="text" class="form-control" id="searchInput" placeholder="search"
                                            aria-describedby="inputGroupPrepend" oninput="search()">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text" id="inputGroupPrepend"><i
                                                    class="ti-search"></i></span>
                                        </div>
                                    </div>
                                    <div id="searchResults"></div>

                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="breadcrumb_iner_item">

                        <!-- <p>Home <span>-</span> Shop Category</p> -->
                    </div>
                    <script>
                        function search() {
                            const searchTerm = $('#searchInput').val().trim();
                            const categoryId = $('#categorySelect').val(); 
                             
                            $.ajax({
                                url: "/searchFilter", // Update the URL to your server-side search endpoint
                                method: "POST",
                                data: { searchTerm: searchTerm ,categoryId:categoryId},
                                success: function (response) {
                                    const products = response.products;


                                    $('#product-list').empty(); // Clear existing products
                                    products.forEach(product => {
                                        $('#product-list').append(`
    <div class="col-lg-4 col-sm-6">
        <div class="single_product_item">
            <a >
                <img src="SharpImage/${product.image[1]}" alt="img">
            </a>
            <div class="single_product_text">
                <h4>${product.name}</h4>
                ${product.Offer ? `
                        <h7>
                            <h3>₹${(product.price - (product.price * product.Offer.percentage / 100)).toFixed(2)}</h3>
                            <del>₹${product.price}</del>
                        </h7>
                    ` : product.category.Offer ? `
                        <h3>₹${(product.price - (product.price * product.category.Offer.percentage / 100)).toFixed(2)}</h3>
                        <del>₹${product.price}</del>
                    ` : `
                        <h3>₹${product.price}</h3>
                    `
                                            }
                <!-- Add to Cart button -->
                <a href="#" class="add_cart" onclick="addToCart('${product._id}','${product.name}','${product.price}','${product.category.name}','${product.brand}')">+ Add to Cart</a>
                <a href="#" class="add_wishlist" onclick="addToWishlist('${product._id}')">Add to Wishlist</a>
            </div>
        </div>
    </div>
`);

                                    });
                                },
                                error: function (error) {
                                    console.error('Error:', error);
                                }
                            });
                        }

                    </script>
                    
                    <div class="row align-items-center latest_product_inner" id="product-list">

                        <% if(products.length> 0) { %>
                            <% for(let i=0; i < products.length; i++) { %>
                                <div class="col-lg-4 col-sm-6">
                                    <div class="single_product_item">


                                        <a href="/single/?productId=<%= products[i].id %>">
                                            <img src="SharpImage/<%= products[i].image[1] %>" alt="img">
                                        </a>
                                        <div class="single_product_text">
                                            <h4>
                                                <%= products[i].name %>
                                            </h4>
                                            <% if(products[i].Offer){ %>
                                                <h7>

                                                    <h3>₹<%=products[i].price - ((products[i].price *
                                                            products[i].Offer.percentage/100).toFixed(2)) %>
                                                    </h3>
                                                    <del>₹<%= products[i].price %></del>

                                                </h7>
                                                <% }else if (products[i].category.Offer){ %>
                                                    <h3>₹<%=products[i].price - ((products[i].price *
                                                            products[i].category.Offer.percentage/100).toFixed(2)) %>
                                                    </h3>
                                                    <del>₹<%= products[i].price %></del>


                                                    <%}else{%>


                                                        <h3>
                                                            ₹<%= products[i].price %>
                                                        </h3>


                                                        <%}%>
                                                            <!-- Add to Cart button -->
                                                            <a href="#" class="add_cart"
                                                                onclick="addToCart('<%= products[i]._id %>','<%= products[i].name %>','<%= products[i].price%>','<%= products[i].category.name%>','<%= products[i].brand%>','<%= products[i].category._id%>')">
                                                                + Add to Cart
                                                            </a>
                                                            <a href="#" class="add_wishlist"
                                                                onclick="addToWishlist('<%= products[i]._id %>')">
                                                                Add to Wishlist
                                                            </a>


                                        </div>
                                    </div>
                                </div>
                                <% } %>
                                    <% } else { %>
                                        <div class="no-products">
                                            <h1><i class="fas fa-exclamation-circle"></i> There are no products</h1>
                                        </div>
                                        <% } %>
                                            <style>
                                                .no-products {
                                                    text-align: center;
                                                    margin-top: 50px;
                                                    padding: 20px;
                                                    border: 1px solid #ccc;
                                                    border-radius: 5px;
                                                    background-color: #f9f9f9;
                                                }

                                                .no-products h1 {
                                                    color: #333;
                                                    font-size: 24px;
                                                    font-weight: bold;
                                                }

                                                .no-products i {
                                                    color: #f44336;
                                                    /* Icon color */
                                                    margin-right: 5px;
                                                }
                                            </style>


                    </div>
                </div>
            </div>
        </div>
    </section>
    <!--================End Category Product Area =================-->

    <!--::footer_part start::-->
    <footer class="footer_part">
        <div class="container">
            <div class="row justify-content-around">
                <div class="col-sm-6 col-lg-2">
                    <div class="single_footer_part">
                        <h4>Top Products</h4>
                        <ul class="list-unstyled">
                            <li><a href="">Managed Website</a></li>
                            <li><a href="">Manage Reputation</a></li>
                            <li><a href="">Power Tools</a></li>
                            <li><a href="">Marketing Service</a></li>
                        </ul>
                    </div>
                </div>
                <div class="col-sm-6 col-lg-2">
                    <div class="single_footer_part">
                        <h4>Quick Links</h4>
                        <ul class="list-unstyled">
                            <li><a href="">Jobs</a></li>
                            <li><a href="">Brand Assets</a></li>
                            <li><a href="">Investor Relations</a></li>
                            <li><a href="">Terms of Service</a></li>
                        </ul>
                    </div>
                </div>
                <div class="col-sm-6 col-lg-2">
                    <div class="single_footer_part">
                        <h4>Features</h4>
                        <ul class="list-unstyled">
                            <li><a href="">Jobs</a></li>
                            <li><a href="">Brand Assets</a></li>
                            <li><a href="">Investor Relations</a></li>
                            <li><a href="">Terms of Service</a></li>
                        </ul>
                    </div>
                </div>
                <div class="col-sm-6 col-lg-2">
                    <div class="single_footer_part">
                        <h4>Resources</h4>
                        <ul class="list-unstyled">
                            <li><a href="">Guides</a></li>
                            <li><a href="">Research</a></li>
                            <li><a href="">Experts</a></li>
                            <li><a href="">Agencies</a></li>
                        </ul>
                    </div>
                </div>
                <div class="col-sm-6 col-lg-4">
                    <div class="single_footer_part">
                        <h4>Newsletter</h4>
                        <p>Heaven fruitful doesn't over lesser in days. Appear creeping
                        </p>
                        <div id="mc_embed_signup">
                            <form target="_blank"
                                action="https://spondonit.us12.list-manage.com/subscribe/post?u=1462626880ade1ac87bd9c93a&amp;id=92a4423d01"
                                method="get" class="subscribe_form relative mail_part">
                                <input type="email" name="email" id="newsletter-form-email" placeholder="Email Address"
                                    class="placeholder hide-on-focus" onfocus="this.placeholder = ''"
                                    onblur="this.placeholder = ' Email Address '">
                                <button type="submit" name="submit" id="newsletter-submit"
                                    class="email_icon newsletter-submit button-contactForm">subscribe</button>
                                <div class="mt-10 info"></div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

        </div>
        <div class="copyright_part">
            <div class="container">
                <div class="row">
                    <div class="col-lg-8">
                        <div class="copyright_text">
                            <P><!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                                Copyright &copy;
                                <script>document.write(new Date().getFullYear());</script> All rights reserved | This
                                template is made with <i class="ti-heart" aria-hidden="true"></i> by <a
                                    href="https://colorlib.com" target="_blank">Colorlib</a>
                                <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                            </P>
                        </div>
                    </div>
                    <div class="col-lg-4">
                        <div class="footer_icon social_icon">
                            <ul class="list-unstyled">
                                <li><a href="#" class="single_social_icon"><i class="fab fa-facebook-f"></i></a></li>
                                <li><a href="#" class="single_social_icon"><i class="fab fa-twitter"></i></a></li>
                                <li><a href="#" class="single_social_icon"><i class="fas fa-globe"></i></a></li>
                                <li><a href="#" class="single_social_icon"><i class="fab fa-behance"></i></a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!--::footer_part end::-->

    <!-- jquery plugins here-->
    <script src="js/jquery-1.12.1.min.js"></script>
    <!-- popper js -->
    <script src="js/popper.min.js"></script>
    <!-- bootstrap js -->
    <script src="js/bootstrap.min.js"></script>
    <!-- easing js -->
    <script src="js/jquery.magnific-popup.js"></script>
    <!-- swiper js -->
    <script src="js/swiper.min.js"></script>
    <!-- swiper js -->
    <script src="js/masonry.pkgd.js"></script>
    <!-- particles js -->
    <script src="js/owl.carousel.min.js"></script>
    <script src="js/jquery.nice-select.min.js"></script>
    <!-- slick js -->
    <script src="js/slick.min.js"></script>
    <script src="js/jquery.counterup.min.js"></script>
    <script src="js/waypoints.min.js"></script>
    <script src="js/contact.js"></script>
    <script src="js/jquery.ajaxchimp.min.js"></script>
    <script src="js/jquery.form.js"></script>
    <script src="js/jquery.validate.min.js"></script>
    <script src="js/mail-script.js"></script>
    <script src="js/stellar.js"></script>
    <script src="js/price_rangs.js"></script>
    <!-- custom js -->
    <script src="js/custom.js"></script>
    <!-- Include SweetAlert script -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>

    <script>
        function addToWishlist(productId) {
            // swal.fire({
            //     title: 'Add to Wishlist',
            //     text: 'Do you want to add this product to your wishlist?',
            //     icon: 'question',
            //     showCancelButton: true,
            //     confirmButtonText: 'Yes',
            //     cancelButtonText: 'No'
            // }).then((result) => {
            //     if (result.isConfirmed) {
            fetch('/wishlist', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ productId: productId })
            }).then(response => response.json())
                .then(response => {
                    if (response.success) {
                        swal.fire("Success", "Product added to wishlist", "success");
                        console.log('Product added to wishlist:', productId);
                    } else {
                        swal.fire("Error", "Product already exists in the wishlist", "error");
                        console.error('Failed to add product to wishlist:', productId);
                    }
                })
                .catch(error => {
                    console.error('Error adding product to wishlist:', error);

                });
            // }
            // });
        }

    </script>
    <script>

        function addToCart(productId, productName, productPrice, category, brand,categoryId) {
            let user = document.getElementById("user").value;

            if (!user) {

                Swal.fire({
                    icon: 'info',
                    title: 'Login Required',
                    text: 'Please login to add items to your cart.',
                    showCancelButton: true,
                    confirmButtonText: 'Login',
                    cancelButtonText: 'Cancel',
                }).then((result) => {
                    if (result.isConfirmed) {

                        window.location.href = '/login';
                    }
                });
                return;



            }

            Swal.fire({
                icon: 'question',
                title: 'Add to Cart',
                text: `Do you want to add ${productName} to your cart?`,
                showCancelButton: true,
                confirmButtonText: 'Yes',
                cancelButtonText: 'No',
            }).then((result) => {
                if (result.isConfirmed) {


                    const quantity = 1;
                    fetch('/add-to-cart', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            productId, productName, productPrice, quantity, category, brand,categoryId
                        }),
                    })
                        .then(response => response.json())
                        .then(data => {
                            if (data.success === false) {
                                Swal.fire({
                                    icon: 'info',
                                    title: 'Info',
                                    text: data.message,
                                });
                            } else {
                                // Handle success response
                                console.log(data.message);
                                // Show success message
                                Swal.fire({
                                    icon: 'success',
                                    title: 'Added to cart!',
                                    text: `${productName} has been added to your cart.`,
                                    showConfirmButton: false,
                                    timer: 1500
                                });
                            }
                        })


                        .catch(error => {
                            console.error('Error adding to cart:', error);
                            // Show error message
                            Swal.fire({
                                icon: 'error',
                                title: 'Error',
                                text: 'Failed to add the item to the cart. Please try again.',
                            });
                        });
                } else {
                    // User clicked "No," do nothing or show a different message
                }
            });
        }

    </script>
</body>

</html>